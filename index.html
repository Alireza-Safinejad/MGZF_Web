<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>سامانه شیفت شرکت گهرزمین</title>
  <style>
    :root{
      --brand:#003087;
      --bg:#0f172a; 
      --card:#111827;
      --muted:#94a3b8;
      --text:#e5e7eb;
      --accent:#2563eb;
      --ok:#16a34a;
      --danger:#dc2626;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0}
    body{
      display:flex; align-items:center; justify-content:center;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Naskh Arabic UI", "Vazirmatn", Arial, sans-serif;
      background:linear-gradient(180deg,#0a0f1f 0%, #0f172a 100%);
      color:var(--text);
    }
    /* پس زمینه لوگو */
    body::before{
      content:""; position:fixed; inset:0;
      background:url("Gz.PNG") no-repeat center/400px;
      opacity:.07; filter:blur(1px);
      z-index:-1;
    }
    .card{
      width:min(520px, 92vw); background:rgba(17,24,39,.65); backdrop-filter: blur(8px);
      border:1px solid rgba(255,255,255,.06); border-radius:var(--radius); box-shadow:var(--shadow); padding:24px;
    }
    .center{display:flex; align-items:center; justify-content:center}
    .logo{
      width:120px;height:120px;border-radius:50%; display:grid; place-items:center; box-shadow:0 12px 40px rgba(0,48,135,.45), inset 0 0 0 6px rgba(255,255,255,.08);
      margin:24px auto 16px; overflow:hidden;
    }
    .logo img{width:100%; height:100%; object-fit:cover;}
    h1{margin:.25rem 0 1rem 0; font-size:1.4rem; text-align:center}
    p.muted{color:var(--muted); text-align:center; margin:.25rem 0 1.25rem 0}
    label{display:block; font-size:.95rem; margin:.5rem 0 .35rem 0; color:#cbd5e1}
    input, textarea{
      width:100%; padding:12px 14px; border-radius:10px; outline:none;
      border:1px solid rgba(0,0,0,.15); background:#fff; color:#111;
    }
    input:focus, textarea:focus{border-color:#2563eb; box-shadow:0 0 0 3px rgba(37,99,235,.25)}
    .btn{
      width:100%; margin-top:14px; padding:12px 16px; border-radius:10px; border:none; color:white; background:linear-gradient(90deg,#2563eb,#1d4ed8);
      cursor:pointer; font-size:1rem; font-weight:700; letter-spacing:.3px; box-shadow:0 8px 26px rgba(37,99,235,.35);
    }
    .btn:active{transform: translateY(1px)}
    .alert{margin:.5rem 0; padding:.6rem .8rem; border-radius:10px; font-size:.95rem; background:#1f2937}
    .alert.ok{border:1px solid rgba(22,163,74,.45); color:#bbf7d0; background:rgba(22,163,74,.12)}
    .alert.err{border:1px solid rgba(220,38,38,.45); color:#fecaca; background:rgba(220,38,38,.12)}
    .grid{display:grid; gap:12px}
    .grid.kpi{grid-template-columns: repeat(2, minmax(0,1fr))}
    .tile{
      background:rgba(2,6,23,.55); border:1px solid rgba(255,255,255,.05);
      padding:14px; border-radius:12px;
    }
    .tile h3{margin:.2rem 0 .4rem 0; font-size:1rem}
    .tile .v{color:#e2e8f0; font-weight:700}
    .footer{margin-top:12px; color:#94a3b8; font-size:.85rem; text-align:center}
    .back{display:inline-flex; gap:8px; align-items:center; color:#93c5fd; cursor:pointer; margin-bottom:12px}
    #splash{position:fixed; inset:0; display:grid; place-items:center; background:#0a0f1f; z-index:10}
    #splash.fade{animation: fadeout .5s ease forwards}
    @keyframes fadeout{to{opacity:0; visibility:hidden}}
    textarea{resize:none; min-height:80px;}
  </style>
</head>
<body>

  <!-- Splash -->
  <div id="splash">
    <div class="center" style="flex-direction:column">
      <div class="logo"><img src="Gz.PNG" alt="لوگو شرکت"></div>
      <p class="muted">در حال آماده‌سازی…</p>
    </div>
  </div>

  <!-- Login -->
  <div id="screen-login" class="card" style="display:none">
    <div class="logo"><img src="Gz.PNG" alt="لوگو شرکت"></div>
    <h1>ورود به سامانه شیفت شرکت گهرزمین</h1>
    <p class="muted">نام کاربری و رمز عبور را وارد کنید.</p>
    <div id="login-alert" class="alert err" style="display:none"></div>
    <label>نام کاربری</label>
    <input id="username" placeholder="مثلاً: 1 یا 1000" autocomplete="username">
    <label>رمز عبور</label>
    <input id="password" type="password" placeholder="۱۲۳" autocomplete="current-password">
    <button id="btn-login" class="btn">ورود</button>
    <div class="footer">© Gohar Zamin • Demo</div>
  </div>

  <!-- Units -->
  <div id="screen-units" class="card" style="display:none">
    <div class="back" onclick="showScreen('login')">← بازگشت به ورود</div>
    <h1>انتخاب واحد</h1>
    <div class="grid">
      <button class="btn" data-unit="mine">واحد معدن</button>
      <button class="btn" data-unit="processing">واحد فرآوری و خردایش</button>
      <button class="btn" data-unit="pellet">واحد گندله سازی</button>
      <button class="btn" data-unit="energy">واحد انرژی و سیالات</button>
      <button class="btn" data-unit="lab">واحد آزمایشگاه</button>
    </div>
  </div>

  <!-- Shifts -->
  <div id="screen-shifts" class="card" style="display:none">
    <div class="back" onclick="showScreen('units')">← بازگشت به واحدها</div>
    <h1 id="unit-title">شیفت‌ها</h1>
    <div class="grid" id="shifts-grid"></div>
  </div>

  <!-- KPI / Reports -->
  <div id="screen-details" class="card" style="display:none">
    <div class="back" onclick="showScreen('shifts')">← بازگشت به شیفت‌ها</div>
    <h1 id="shift-title">جزئیات شیفت</h1>
    <p id="shift-hours"></p>
    <p id="shift-supervisor"></p>
    <div class="grid kpi" id="kpi-grid"></div>
    <h3>شرح گزارش</h3>
    <textarea id="shift-report"></textarea>
    <label>نظر مدیر واحد</label>
    <textarea id="manager-comment"></textarea>
  </div>

  <script>
    setTimeout(() => {
      document.getElementById('splash').classList.add('fade');
      setTimeout(()=> showScreen('login'), 350);
    }, 2000);

    let userRole = null;

    function showScreen(name){
      document.getElementById('screen-login').style.display = (name==='login')?'block':'none';
      document.getElementById('screen-units').style.display = (name==='units')?'block':'none';
      document.getElementById('screen-shifts').style.display = (name==='shifts')?'block':'none';
      document.getElementById('screen-details').style.display = (name==='details')?'block':'none';
    }

    document.getElementById('btn-login').addEventListener('click', ()=>{
      const u = document.getElementById('username').value.trim();
      const p = document.getElementById('password').value.trim();
      const alertBox = document.getElementById('login-alert');
      if(p !== '123'){
        alertBox.textContent='رمز عبور اشتباه است';
        alertBox.style.display='block';
        return;
      }
      if(Number(u)>=1 && Number(u)<=5){ userRole='admin'; }
      else if(Number(u)>=1000 && Number(u)<=1800){ userRole='user'; }
      else { alertBox.textContent='نام کاربری نامعتبر است'; alertBox.style.display='block'; return; }
      alertBox.style.display='none';
      showScreen('units');
    });

    const unitsData = {
      mine: {name:"واحد معدن", shifts:[
        {name:'A', hours:'07:00 - 15:00', supervisor:'سعید', kpi:{FeO:'12.5%', Humidity:'8.2%', Blending:'3500', Production:'500 تن', Reject:'2.1%'}},
        {name:'B', hours:'15:00 - 23:00', supervisor:'نورمندی', kpi:{FeO:'13%', Humidity:'9%', Blending:'3600', Production:'520 تن', Reject:'2.0%'}},
        {name:'C', hours:'23:00 - 07:00', supervisor:'امامی', kpi:{FeO:'11.5%', Humidity:'7.8%', Blending:'3400', Production:'480 تن', Reject:'2.3%'}},
        {name:'D', hours:'—', supervisor:'روح الامینی', kpi:{FeO:'-', Humidity:'-', Blending:'-', Production:'-', Reject:'-'}}
      ]}
    };

    let currentUnit = null;

    document.querySelectorAll('#screen-units .btn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const unitKey = btn.dataset.unit;
        currentUnit = unitKey;
        document.getElementById('unit-title').textContent = unitsData[unitKey].name + ' - شیفت‌ها';
        const grid = document.getElementById('shifts-grid');
        grid.innerHTML='';
        unitsData[unitKey].shifts.forEach(shift=>{
          const b = document.createElement('button');
          b.className='btn';
          b.textContent = `شیفت ${shift.name}`;
          b.dataset.shift=shift.name;
          grid.appendChild(b);
          b.addEventListener('click', ()=>{
            renderShift(unitKey, shift.name);
            showScreen('details');
          });
        });
        showScreen('shifts');
      });
    });

    function renderShift(unit, shiftName){
      const shift = unitsData[unit].shifts.find(s=>s.name===shiftName);
      document.getElementById('shift-title').textContent = `${unitsData[unit].name} - شیفت ${shift.name}`;
      document.getElementById('shift-hours').textContent = `ساعت: ${shift.hours}`;
      document.getElementById('shift-supervisor').textContent = `سرپرست: ${shift.supervisor}`;
      const grid = document.getElementById('kpi-grid');
      grid.innerHTML='';
      for (const [k,v] of Object.entries(shift.kpi)){
        const el = document.createElement('div');
        el.className='tile';
        el.innerHTML=`<h3>${k}</h3><div class="v">${v}</div>`;
        grid.appendChild(el);
      }
      const reportField = document.getElementById('shift-report');
      const managerField = document.getElementById('manager-comment');
      if(userRole==='admin'){
        reportField.value='گزارش در حال بروز رسانی است';
        reportField.disabled=true;
        managerField.value='';
        managerField.disabled=false;
      } else {
        reportField.value='';
        reportField.disabled=false;
        managerField.value='در حال بروز رسانی';
        managerField.disabled=true;
      }
    }
  </script>
</body>
</html>
