<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>گهرزمین – Factory Monitor (Web)</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root{
  --brand:#003087; --bg:#0f172a; --card:#111827; --muted:#94a3b8; --text:#e5e7eb;
  --accent:#2563eb; --ok:#16a34a; --danger:#dc2626; --shadow: 0 10px 30px rgba(0,0,0,.25);
  --radius:14px;
}
*{box-sizing:border-box}
html,body{height:100%; margin:0; background:#0f172a; color:var(--text); font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Vazirmatn",Arial,sans-serif; display:flex; align-items:center; justify-content:center;}
.card{width:min(520px,92vw); background:var(--card); border-radius:var(--radius); padding:24px; box-shadow:var(--shadow);}
.center{display:flex; align-items:center; justify-content:center;}
.logo{width:120px;height:120px;border-radius:50%; background:var(--brand); display:grid; place-items:center; margin:24px auto 16px; font-size:44px; font-weight:800; color:white;}
h1{text-align:center; margin:0.5rem 0;}
p.muted{text-align:center; color:var(--muted);}
input{width:100%; padding:12px; margin:4px 0 12px 0; border-radius:10px; border:1px solid rgba(255,255,255,.2); background:#0b1324; color:var(--text);}
.btn{width:100%; padding:12px; border:none; border-radius:10px; background:var(--accent); color:white; font-weight:700; cursor:pointer; margin-top:10px;}
.alert{padding:6px 10px; border-radius:10px; margin:5px 0; display:none;}
.alert.err{background:rgba(220,38,38,.1); border:1px solid rgba(220,38,38,.4); color:#fecaca;}
.grid{display:grid; gap:12px;}
.grid.kpi{grid-template-columns: repeat(2,1fr);}
.tile{background:rgba(2,6,23,.55); border-radius:12px; padding:12px;}
.footer{text-align:center; margin-top:12px; color:var(--muted);}
.back{cursor:pointer; color:#93c5fd; margin-bottom:12px; display:inline-block;}
</style>
</head>
<body>

<!-- Splash -->
<div id="splash" class="center" style="position:fixed; inset:0; background:#0b1324; z-index:10; flex-direction:column;">
  <div class="logo">GZ</div>
  <p class="muted">در حال آماده‌سازی…</p>
</div>

<!-- Login -->
<div id="screen-login" class="card" style="display:none;">
  <div class="logo">GZ</div>
  <h1>ورود به سامانه مانیتورینگ</h1>
  <p class="muted">نام کاربری و رمز عبور را وارد کنید.</p>
  <div id="login-alert" class="alert err"></div>
  <input id="username" placeholder="نام کاربری" autocomplete="username">
  <input id="password" type="password" placeholder="رمز عبور" autocomplete="current-password">
  <button id="btn-login" class="btn">ورود</button>
  <div class="footer">© Gohar Zamin • Demo</div>
</div>

<!-- Shifts -->
<div id="screen-shifts" class="card" style="display:none;">
  <div class="back" id="back-to-login">← خروج</div>
  <h1>شیفت‌های کارخانه گندله‌سازی</h1>
  <div class="grid" id="shift-grid"></div>
  <div class="footer">انتخاب شیفت برای مشاهده KPI</div>
</div>

<!-- Shift Details -->
<div id="screen-details" class="card" style="display:none;">
  <div class="back" id="back-to-shifts">← بازگشت به شیفت‌ها</div>
  <h1 id="shift-title">جزئیات شیفت</h1>
  <p id="shift-info" style="text-align:center; margin:5px 0;"></p>
  <div class="grid kpi" id="kpi-grid"></div>
</div>

<script>
// Splash
setTimeout(()=>{document.getElementById('splash').style.display='none'; showScreen('login');}, 2000);

// Screen controller
function showScreen(name){
  document.getElementById('screen-login').style.display = (name==='login')?'block':'none';
  document.getElementById('screen-shifts').style.display = (name==='shifts')?'block':'none';
  document.getElementById('screen-details').style.display = (name==='details')?'block':'none';
}

// Login
document.getElementById('btn-login').addEventListener('click', ()=>{
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  const alertBox = document.getElementById('login-alert');
  if(u==='admin' && p==='123'){ alertBox.style.display='none'; showScreen('shifts'); initShifts(); }
  else{ alertBox.textContent='نام کاربری یا رمز اشتباه است'; alertBox.style.display='block'; }
});

// --- Shifts data
const shifts = [
  {name:'A', start:'07:00', end:'15:00', manager:'سعید'},
  {name:'B', start:'15:00', end:'23:00', manager:'نورمندی'},
  {name:'C', start:'23:00', end:'07:00', manager:'امامی'},
  {name:'D', start:'- استراحت -', end:'-', manager:'روح الامینی'}
];

// Mock KPI data
const mockData = {
  'آلارم‌ها':'آلارم سنسور 1، آلارم رطوبت بالا',
  'توقفات':'توقف 2 ساعته در خط تولید',
  'درصد رطوبت':'8.2%',
  'درصد FeO':'12.5%',
  'میزان بلین':'3500',
  'میزان تولید در ساعت':'500 تن',
  'میزان ریجکتی':'2.1%',
};

// Init shift buttons
function initShifts(){
  const grid = document.getElementById('shift-grid');
  grid.innerHTML='';
  shifts.forEach(s=>{
    const btn = document.createElement('button');
    btn.className='btn';
    btn.textContent=`شیفت ${s.name} - ${s.start} تا ${s.end} (${s.manager})`;
    if(isShiftActive(s)) btn.textContent += ' (در حال اجرا)';
    btn.addEventListener('click', ()=> showShiftDetails(s));
    grid.appendChild(btn);
  });
}

// Active shift logic
function isShiftActive(s){
  const now = new Date();
  const h = now.getHours();
  if(s.name==='A' && h>=7 && h<15) return true;
  if(s.name==='B' && h>=15 && h<23) return true;
  if(s.name==='C' && (h>=23 || h<7)) return true;
  return false;
}

// Show shift details
function showShiftDetails(shift){
  showScreen('details');
  document.getElementById('shift-title').textContent='جزئیات شیفت '+shift.name;
  document.getElementById('shift-info').textContent=`مدیر: ${shift.manager} | ساعت: ${shift.start} - ${shift.end}`;
  const grid = document.getElementById('kpi-grid');
  grid.innerHTML='';
  Object.entries(mockData).forEach(([k,v])=>{
    const div = document.createElement('div');
    div.className='tile';
    div.innerHTML=`<h3>${k}</h3><canvas id="chart-${k}"></canvas><p style="text-align:center;">${v}</p>`;
    grid.appendChild(div);
    const ctx = div.querySelector('canvas').getContext('2d');
    new Chart(ctx,{type:'bar',data:{labels:[k],datasets:[{label:k,data:[Math.random()*100],backgroundColor:'#2563eb'}]}});
  });
}

// Back buttons
document.getElementById('back-to-login').addEventListener('click', ()=> showScreen('login'));
document.getElementById('back-to-shifts').addEventListener('click', ()=> showScreen('shifts'));

</script>
</body>
</html>
